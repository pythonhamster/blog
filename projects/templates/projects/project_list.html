{% extends "base.html" %}
{% load static %}

{% block title %}Projects â€” {{ site_title }}{% endblock %}

{% block content %}
  <style>
    /* Scoped to the Projects page only */
    .projects-hero { margin: 8px 0 16px; }
    .projects-hero h1 { margin: 0 0 6px; color: #1e293b; }
    .projects-hero p  { margin: 0; color: var(--muted); }

    .projects-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
      margin-top: 10px;
    }
    @media (min-width: 760px)  { .projects-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 1100px) { .projects-grid { grid-template-columns: repeat(3, 1fr); } }

    .proj-card.card {
      border: 1px solid var(--line);
      border-radius: var(--radius);
      overflow: hidden;
      background: var(--card);
      box-shadow: var(--shadow);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
      position: relative;
    }
    .proj-card.card:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(30,41,59,.12); border-color: #cfe0ff; }

    .proj-link { display: block; color: inherit; text-decoration: none; }

    /* Media keeps your global ratio utilities if present; fallback here as well */
    .proj-thumb { aspect-ratio: 16 / 9; background: #e2e8f0; }
    .proj-thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }

    .proj-body { padding: 14px 16px 52px; }
    .proj-title { margin: 0 0 6px; font-size: 1.05rem; color: var(--text); }
    .proj-desc  { margin: 0; color: var(--muted); line-height: 1.6; }

    /* Developer overlay (bottom-left) */
    .devs {
      position: absolute; left: 12px; bottom: 12px;
      display: flex; gap: 10px; align-items: center;
      background: var(--accent-soft); /* pale blue */
      color: var(--text);
      padding: 6px 8px; border-radius: 10px;
      border: 1px solid var(--line);
      box-shadow: 0 4px 14px rgba(30,41,59,.08);
    }
    .dev { display: flex; align-items: center; gap: 6px; }
    .dev img {
      width: 26px; height: 26px; border-radius: 50%;
      object-fit: cover; border: 1px solid var(--line); background: #fff;
    }
    .dev span { font-size: .85rem; color: #334155; }

    /* Empty state */
    .empty-card {
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: var(--card);
      box-shadow: var(--shadow);
      padding: 18px;
      text-align: center;
      color: var(--muted);
    }
  </style>

  <section class="projects-hero">
    <h1>Projects</h1>
    <p>Clean builds, neat code, and polished launches.</p>
  </section>

  {% if projects %}
    <div class="projects-grid">
      {% for p in projects %}
        <article class="proj-card card">
          <a class="proj-link" href="{% url 'projects:project-detail' p.pk %}">
            <div class="proj-thumb">
              {% if p.photo %}
                <img src="{{ p.photo.url }}" alt="{{ p.name }}" loading="lazy">
              {% else %}
                <img src="{% static 'img/placeholder-16x9.jpg' %}" alt="Placeholder" loading="lazy">
              {% endif %}
            </div>
            <div class="proj-body">
              <h2 class="proj-title">{{ p.name }}</h2>
              <p class="proj-desc">{{ p.description|default_if_none:""|truncatewords:30 }}</p>
            </div>
          </a>

          <!-- Bottom-left developer credits -->
          <div class="devs">
            {% for d in p.developers.all %}
              <div class="dev">
                {% if d.profile_photo %}
                  <img src="{{ d.profile_photo.url }}" alt="{{ d.first_name }}" loading="lazy">
                {% else %}
                  <img src="{% static 'img/avatar.png' %}" alt="Avatar" loading="lazy">
                {% endif %}
                <span>{{ d.first_name }}</span>
              </div>
            {% empty %}
              <span style="font-size:.85rem;">Unassigned</span>
            {% endfor %}
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty-card">No projects yet.</div>
  {% endif %}
{% endblock %}
